<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AstroNeko ‚Äî –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∞–Ω—ñ–º–µ</title>
  <link rel="icon" href="images/favicon.png" type="image/png">
  <link rel="stylesheet" href="style/anime-info.css">
</head>
<body>
  <div class="anime-bg" id="anime-bg"></div>
  <header>
    <a href="index.html" class="logo">
      <img src="images/favicon1.png" alt="Logo">
      <h1>AstroNeko</h1>
    </a>
  </header>

  <main id="anime-info">
    <div class="anime-header">
      <div class="anime-title-section">
        <img id="anime-image" src="" alt="Anime poster">
        <div class="anime-meta">
          <h2 id="anime-title">–ù–∞–∑–≤–∞ –∞–Ω—ñ–º–µ</h2>
          <p id="anime-description">–û–ø–∏—Å –∞–Ω—ñ–º–µ...</p>
          <p><strong>–ñ–∞–Ω—Ä–∏:</strong> <span id="anime-tags"></span></p>
          <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="anime-status"></span></p>
          <p><strong>–í—ñ–∫:</strong> <span id="anime-age"></span></p>
          <p><strong>–û—Ü—ñ–Ω–∫–∞:</strong> <span id="anime-rating"></span></p>
        </div>
      </div>
    </div>

    <section class="anime-seasons">
      <h3>–°–µ–∑–æ–Ω–∏ —Ç–∞ —Å–µ—Ä—ñ—ó</h3>
      <div id="season-list"></div>
    </section>
  </main>

  <script>
    // –û—Ç—Ä–∏–º—É—î–º–æ ID –∞–Ω—ñ–º–µ –∑ URL
    const params = new URLSearchParams(window.location.search);
    const animeId = params.get("id");

    if (!animeId) {
      document.body.innerHTML = "<h2 style='text-align:center; margin-top:50px;'>–ê–Ω—ñ–º–µ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ üòø</h2>";
    } else {
      loadAnime(animeId);
    }

    async function loadAnime(id) {
      try {
        const response = await fetch(`anime/${encodeURIComponent(id)}.json`);
        if (!response.ok) throw new Error("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ JSON –¥–ª—è —Ü—å–æ–≥–æ –∞–Ω—ñ–º–µ");

        const anime = await response.json();
        displayAnimeInfo(anime);
      } catch (error) {
        document.body.innerHTML = "<h2 style='text-align:center; margin-top:50px;'>–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∞–Ω—ñ–º–µ üòø</h2>";
        console.error(error);
      }
    }

    function displayAnimeInfo(anime) {
      document.title = `AstroNeko ‚Äî ${anime.title}`;
      document.getElementById("anime-bg").style.backgroundImage = `url('${anime.background}')`;
      document.getElementById("anime-image").src = anime.img;
      document.getElementById("anime-title").textContent = anime.title;
      document.getElementById("anime-description").textContent = anime.description;
      document.getElementById("anime-tags").textContent = anime.tags.join(", ");
      document.getElementById("anime-status").textContent = anime.status;
      document.getElementById("anime-age").textContent = anime.age;
      document.getElementById("anime-rating").textContent = anime.rating || "N/A";

      const seasonList = document.getElementById("season-list");
      seasonList.innerHTML = "";

      // –ì–µ–Ω–µ—Ä—É—î–º–æ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Å–µ–∑–æ–Ω—ñ–≤ —Ç–∞ —Å–µ—Ä—ñ–π
      anime.seasons.forEach(season => {
        const seasonDiv = document.createElement("div");
        seasonDiv.classList.add("season");

        const seasonTitle = document.createElement("h4");
        seasonTitle.textContent = `–°–µ–∑–æ–Ω ${season.seasonNumber}`;
        seasonDiv.appendChild(seasonTitle);

        const episodeContainer = document.createElement("div");
        episodeContainer.classList.add("episode-container");

        season.episodes.forEach((ep, idx) => {
          const btn = document.createElement("button");
          btn.classList.add("episode-btn"); // <-- –¥–æ–¥–∞–ª–∏ –∫–ª–∞—Å
          btn.textContent = ep.title;
          btn.onclick = () => {
            const url = `player.html?id=${encodeURIComponent(anime.id)}&season=${season.seasonNumber}&episode=${idx+1}`;
            window.location.href = url;
          };
          episodeContainer.appendChild(btn);
        });

        seasonDiv.appendChild(episodeContainer);
        seasonList.appendChild(seasonDiv);
      });

      // –§—ñ–ª—å–º–∏, —è–∫—â–æ —î
      if (anime.movies && anime.movies.length > 0) {
        const moviesDiv = document.createElement("div");
        moviesDiv.classList.add("movies");

        const moviesTitle = document.createElement("h4");
        moviesTitle.textContent = "–§—ñ–ª—å–º–∏";
        moviesDiv.appendChild(moviesTitle);

        anime.movies.forEach((mov, idx) => {
          const btn = document.createElement("button");
          btn.classList.add("movie-btn"); // <-- –¥–æ–¥–∞–ª–∏ –∫–ª–∞—Å
          btn.textContent = mov.title;
          btn.onclick = () => {
            const url = `player.html?id=${encodeURIComponent(anime.id)}&movie=${idx+1}`;
            window.location.href = url;
          };
          moviesDiv.appendChild(btn);
        });

        seasonList.appendChild(moviesDiv);
      }
    }
  </script>
</body>
</html>
